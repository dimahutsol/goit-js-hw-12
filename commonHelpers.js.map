{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import { refs } from '../main';\nimport axios from 'axios';\naxios.defaults.baseURL = 'https://pixabay.com';\n\nexport async function getImagesByText(text, page, per_page) {\n  refs.loader.classList.remove('hidden');\n  refs.loadMoreBtn.classList.add('hidden');\n\n  const result = await axios.get('/api/', {\n    params: {\n      key: '44981413-36d40c10f5ea072ce48bfd774',\n      q: text,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page,\n    },\n  });\n\n  return result.data;\n}\n","import { refs } from '../main';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet gallery = new SimpleLightbox('.gallery-item a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nfunction createCardMarkup({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  return `<li class=\"gallery-item\">\n          <a href=\"${largeImageURL}\">\n            <div class=\"gallery-card\">\n              <img\n                src=\"${webformatURL}\"\n                alt=\"${tags}\"\n                class=\"gallery-card-image\"\n              />\n              <div class=\"gallery-card-info\">\n                <div class=\"gallery-card-item\">\n                  <h3 class=\"gallery-card-top\">Likes</h3>\n                  <p class=\"gallery-card-bottom\">${likes}</p>\n                </div>\n                <div class=\"gallery-card-item\">\n                  <h3 class=\"gallery-card-top\">Views</h3>\n                  <p class=\"gallery-card-bottom\">${views}</p>\n                </div>\n                <div class=\"gallery-card-item\">\n                  <h3 class=\"gallery-card-top\">Comments</h3>\n                  <p class=\"gallery-card-bottom\">${comments}</p>\n                </div>\n                <div class=\"gallery-card-item\">\n                  <h3 class=\"gallery-card-top\">Downloads</h3>\n                  <p class=\"gallery-card-bottom\">${downloads}</p>\n                </div>\n              </div>\n            </div>\n          </a>\n        </li>`;\n}\n\nfunction createGalleryMarkup(items) {\n  return items.map(createCardMarkup).join(' ');\n}\n\nexport function renderGallery(items) {\n  const galleryMarkup = createGalleryMarkup(items);\n  refs.galleryList.innerHTML = galleryMarkup;\n  gallery.refresh();\n}\n\nexport function renderMorePhotos(items) {\n  const galleryMarkup = createGalleryMarkup(items);\n  refs.galleryList.insertAdjacentHTML('beforeend', galleryMarkup);\n  gallery.refresh();\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { getImagesByText } from './js/pixabay-api';\nimport { renderGallery, renderMorePhotos } from './js/render-functions';\n\nexport const refs = {\n  form: document.querySelector('.form'),\n  galleryList: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  loadMoreBtn: document.querySelector('.js-load-button'),\n};\n\nlet textToSearch;\nlet page;\nconst per_page = 15;\nlet totalPages;\nlet cardHeight;\n\nrefs.form.addEventListener('submit', handleFormSubmit);\nrefs.loadMoreBtn.addEventListener('click', handleLoadMoreClick);\n\nasync function handleFormSubmit(e) {\n  try {\n    e.preventDefault();\n\n    refs.galleryList.innerHTML = '';\n    page = 1;\n    textToSearch = e.currentTarget.elements.search.value.trim();\n\n    if (!textToSearch) return;\n    const images = await getImagesByText(textToSearch, page, per_page);\n\n    page += 1;\n    totalPages = Math.ceil(images.totalHits / per_page);\n\n    if (images.length === 0) {\n      throw new Error();\n    }\n    renderGallery(images.hits);\n\n    refs.loader.classList.add('hidden');\n    refs.loadMoreBtn.classList.remove('hidden');\n    e.target.elements.search.value = '';\n    cardHeight = Math.round(\n      refs.galleryList.firstElementChild.getBoundingClientRect().height\n    );\n  } catch {\n    refs.loader.classList.add('hidden');\n    refs.loadMoreBtn.classList.add('hidden');\n    page = 1;\n    totalPages = 0;\n    iziToast.error({\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      position: 'center',\n    });\n  }\n}\n\nasync function handleLoadMoreClick() {\n  if (page > totalPages) {\n    iziToast.info({\n      message: `We're sorry, but you've reached the end of search results.`,\n      position: 'center',\n    });\n    refs.loader.classList.add('hidden');\n    refs.loadMoreBtn.classList.add('hidden');\n    return;\n  }\n\n  const images = await getImagesByText(textToSearch, page, per_page);\n  page += 1;\n\n  renderMorePhotos(images.hits);\n\n  refs.loader.classList.add('hidden');\n  refs.loadMoreBtn.classList.remove('hidden');\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["axios","getImagesByText","text","page","per_page","refs","gallery","SimpleLightbox","createCardMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","createGalleryMarkup","items","renderGallery","galleryMarkup","renderMorePhotos","textToSearch","totalPages","cardHeight","handleFormSubmit","handleLoadMoreClick","e","images","iziToast"],"mappings":"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"}