{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\naxios.defaults.baseURL = 'https://pixabay.com';\n\nexport async function getImagesByText(text, page, per_page) {\n  const result = await axios.get('/api/', {\n    params: {\n      key: '44981413-36d40c10f5ea072ce48bfd774',\n      q: text,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page,\n    },\n  });\n\n  return result.data;\n}\n","import { refs } from '../main';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet gallery = new SimpleLightbox('.gallery-item a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nfunction createCardMarkup({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  return `<li class=\"gallery-item\">\n          <a href=\"${largeImageURL}\">\n            <div class=\"gallery-card\">\n              <img\n                src=\"${webformatURL}\"\n                alt=\"${tags}\"\n                class=\"gallery-card-image\"\n              />\n              <div class=\"gallery-card-info\">\n                <div class=\"gallery-card-item\">\n                  <h3 class=\"gallery-card-top\">Likes</h3>\n                  <p class=\"gallery-card-bottom\">${likes}</p>\n                </div>\n                <div class=\"gallery-card-item\">\n                  <h3 class=\"gallery-card-top\">Views</h3>\n                  <p class=\"gallery-card-bottom\">${views}</p>\n                </div>\n                <div class=\"gallery-card-item\">\n                  <h3 class=\"gallery-card-top\">Comments</h3>\n                  <p class=\"gallery-card-bottom\">${comments}</p>\n                </div>\n                <div class=\"gallery-card-item\">\n                  <h3 class=\"gallery-card-top\">Downloads</h3>\n                  <p class=\"gallery-card-bottom\">${downloads}</p>\n                </div>\n              </div>\n            </div>\n          </a>\n        </li>`;\n}\n\nfunction createGalleryMarkup(items) {\n  return items.map(createCardMarkup).join(' ');\n}\n\nexport function renderGallery(items) {\n  const galleryMarkup = createGalleryMarkup(items);\n  refs.galleryList.innerHTML = galleryMarkup;\n  gallery.refresh();\n}\n\nexport function renderMorePhotos(items) {\n  const galleryMarkup = createGalleryMarkup(items);\n  refs.galleryList.insertAdjacentHTML('beforeend', galleryMarkup);\n  gallery.refresh();\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { getImagesByText } from './js/pixabay-api';\nimport { renderGallery, renderMorePhotos } from './js/render-functions';\n\nexport const refs = {\n  form: document.querySelector('.form'),\n  galleryList: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  loadMoreBtn: document.querySelector('.js-load-button'),\n};\n\nconst per_page = 15;\nlet page;\nlet totalPages;\nlet textToSearch;\nlet cardHeight;\n\nrefs.form.addEventListener('submit', handleFormSubmit);\nrefs.loadMoreBtn.addEventListener('click', handleLoadMoreClick);\n\nasync function handleFormSubmit(e) {\n  try {\n    e.preventDefault();\n\n    textToSearch = e.currentTarget.elements.search.value.trim();\n    if (!textToSearch) return;\n\n    showLoader();\n    refs.galleryList.innerHTML = '';\n    page = 1;\n    const images = await getImagesByText(textToSearch, page, per_page);\n    totalPages = Math.ceil(images.totalHits / per_page);\n\n    if (images.length === 0) {\n      throw new Error();\n    }\n\n    renderGallery(images.hits);\n    updateLoadMoreBtnStatus();\n    e.target.elements.search.value = '';\n    page++;\n\n    cardHeight = Math.round(\n      refs.galleryList.firstElementChild.getBoundingClientRect().height\n    );\n  } catch {\n    hideLoader();\n    hideLoadMoreBtn();\n    page = 1;\n    totalPages = 0;\n    iziToast.error({\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      position: 'center',\n    });\n  }\n}\n\nasync function handleLoadMoreClick() {\n  try {\n    hideLoadMoreBtn();\n    showLoader();\n    const images = await getImagesByText(textToSearch, page, per_page);\n    renderMorePhotos(images.hits);\n    updateLoadMoreBtnStatus();\n\n    page++;\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  } catch (error) {\n    iziToast.error({\n      message: `${error.message}`,\n      position: 'center',\n    });\n  }\n}\n\nfunction updateLoadMoreBtnStatus() {\n  if (page >= totalPages) {\n    iziToast.info({\n      message: `We're sorry, but you've reached the end of search results.`,\n      position: 'center',\n    });\n    hideLoadMoreBtn();\n  } else {\n    showLoadMoreBtn();\n  }\n  hideLoader();\n}\n\nfunction showLoader() {\n  refs.loader.classList.remove('hidden');\n}\n\nfunction hideLoader() {\n  refs.loader.classList.add('hidden');\n}\n\nfunction showLoadMoreBtn() {\n  refs.loadMoreBtn.classList.remove('hidden');\n}\n\nfunction hideLoadMoreBtn() {\n  refs.loadMoreBtn.classList.add('hidden');\n}\n"],"names":["axios","getImagesByText","text","page","per_page","gallery","SimpleLightbox","createCardMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","createGalleryMarkup","items","renderGallery","galleryMarkup","refs","renderMorePhotos","totalPages","textToSearch","cardHeight","handleFormSubmit","handleLoadMoreClick","showLoader","images","updateLoadMoreBtnStatus","hideLoader","hideLoadMoreBtn","iziToast","error","showLoadMoreBtn"],"mappings":"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"}